# ğŸ“š Ollama Ã— FastAPI Ã— LLaVA Ã— ChromaDB  
## ãƒ­ãƒ¼ã‚«ãƒ«ã ã‘ã§å‹•ãã€Œç”»åƒ â†’ Markdown â†’ RAGæ¤œç´¢ã€ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«æ–‡æ›¸è§£æåŸºç›¤

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€

**ç”»åƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆã‚¹ã‚­ãƒ£ãƒ³ç”»åƒãƒ»ãƒ›ãƒ¯ã‚¤ãƒˆãƒœãƒ¼ãƒ‰å†™çœŸãƒ»ã‚¹ãƒ©ã‚¤ãƒ‰ç­‰ï¼‰ã‚’  
ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§è§£æã—ã€Markdown â†’ ãƒ™ã‚¯ãƒˆãƒ«åŒ– â†’ æ¤œç´¢ â†’ QAã¾ã§ä¸€æ°—é€šè²«ã§è¡Œã†  
â€œå®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«ãƒ»ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«RAGåŸºç›¤â€**

ã®å®Ÿè£…ã§ã™ã€‚

ã‚¯ãƒ©ã‚¦ãƒ‰APIä¸è¦ãƒ»ã‚³ã‚¹ãƒˆã‚¼ãƒ­ã§ã€  
**ç”»åƒâ†’Markdownæ§‹é€ åŒ–ï¼ˆLLaVAï¼‰ï¼‹ æ¤œç´¢ï¼ˆbge-m3 / ChromaDBï¼‰ï¼‹ å›ç­”ç”Ÿæˆï¼ˆllama3ï¼‰**  
ã‚’ FastAPI Ã— Web UI ã§æ“ä½œã§ãã¾ã™ã€‚

æ©Ÿå¯†æ–‡æ›¸ã‚’æ‰±ã†ä¼æ¥­ãƒ»ç ”ç©¶å®¤ãƒ»ã‚ªãƒ³ãƒ—ãƒ¬ç’°å¢ƒã«æœ€é©ã§ã™ã€‚

---

# ğŸ§© æ©Ÿèƒ½æ¦‚è¦ï¼ˆOverviewï¼‰

æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæä¾›ã™ã‚‹æ©Ÿèƒ½ï¼š

### ğŸ¨ 1. ç”»åƒ â†’ Markdown è‡ªå‹•å¤‰æ›ï¼ˆLLaVAï¼‰
- å›³ãƒ»è¡¨ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ Markdown ã§æ§‹é€ åŒ–  
- è¦‹å‡ºã— / ç®‡æ¡æ›¸ã / ã‚»ã‚¯ã‚·ãƒ§ãƒ³åŒ–ã‚‚è‡ªå‹•ç”Ÿæˆ  
- ç”»åƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã€Œãƒ†ã‚­ã‚¹ãƒˆåŒ–ã—ã¦æ§‹é€ ã‚’ä¿æŒã€ã§ãã‚‹

### ğŸ§  2. Markdown ã‚’ RAG ãƒŠãƒ¬ãƒƒã‚¸ã¨ã—ã¦ç™»éŒ²
- Markdown â†’ ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²ï¼ˆéšå±¤æ§‹é€ ã«åŸºã¥ãï¼‰
- bge-m3 ã§ Embedding
- ChromaDB ã«ä¿å­˜

### ğŸ” 3. è³ªå•å¿œç­”ï¼ˆRAGï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼è³ªå•ã‚’ Embedding ã—é¡ä¼¼æ–‡è„ˆã‚’æ¤œç´¢
- gpt-oss ãŒæ–‡è„ˆãƒ™ãƒ¼ã‚¹ã§è‡ªç„¶æ–‡å›ç­”

### ğŸŒ 4. Web UI ã«ã‚ˆã‚‹ä¸€è²«æ“ä½œ
- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- Markdownãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
- è³ªå•å…¥åŠ›
- å›ç­”ï¼‹å‚ç…§ãƒãƒ£ãƒ³ã‚¯è¡¨ç¤º

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

```mermaid
graph TD
    Browser -- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ --> FastAPI
    FastAPI -- LLaVAæ¨è«–(Ollama) --> Markdownæ§‹é€ ãƒ†ã‚­ã‚¹ãƒˆ
    Markdownæ§‹é€ ãƒ†ã‚­ã‚¹ãƒˆ -- Markdownãƒãƒ£ãƒ³ã‚¯åˆ†å‰²>bge-m3 embedding>ChromaDBã¸ä¿å­˜ --> æ¤œç´¢å¯èƒ½ãªãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹
    æ¤œç´¢å¯èƒ½ãªãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ -- è³ªå•(Web UI) --> FastAPI
    FastAPI -- gpt-ossã§å›ç­”ç”Ÿæˆ --> WebUIã«å›ç­”è¡¨ç¤º
```

---

# âš™ï¸ ä½¿ç”¨ç’°å¢ƒï¼ˆEnvironmentï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **VLM** | `llava:13b`ï¼ˆOllamaï¼‰ |
| **LLM** | `gpt-oss:20b`ï¼ˆOllamaï¼‰ |
| **Embedding** | `BAAI/bge-m3` |
| **DB** | ChromaDB |
| **Backend** | FastAPI |
| **Frontend** | HTML/CSS/JavaScript |

GPU ãŒã‚ã‚Œã°è‡ªå‹•çš„ã«é«˜é€ŸåŒ–ã•ã‚Œã¾ã™ã€‚

---

# ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆDirectory Structureï¼‰

```

project_root/
â”‚
â”œâ”€â”€ app_full.py          # FastAPIï¼ˆVLM + RAG APIï¼‰
â”œâ”€â”€ rag_pipeline.py      # RAGã‚³ã‚¢ï¼ˆãƒãƒ£ãƒ³ã‚¯ / Embedding / æ¤œç´¢ï¼‰
â”œâ”€â”€ ollama_client.py     # LLaVA å‘¼ã³å‡ºã—ï¼ˆç”»åƒâ†’Markdownï¼‰
â”‚
â”œâ”€â”€ static/
â”‚   â””â”€â”€ index.html        # Web UIï¼ˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ + QAï¼‰
â”‚
â””â”€â”€ README.md

````

---

# ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆSetupï¼‰

## 1. Pythonç’°å¢ƒã®æº–å‚™

```bash
pip install fastapi uvicorn requests python-multipart chromadb sentence-transformers
````

## 2. Ollamaã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

å…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
ğŸ‘‰ [https://ollama.com/](https://ollama.com/)

## 3. ãƒ¢ãƒ‡ãƒ«å–å¾—

```bash
ollama pull llava:13b
ollama pull gpt-oss:20b
```

---

# â–¶ï¸ èµ·å‹•æ–¹æ³•ï¼ˆRunï¼‰

## 1. Ollama ã‚’ç«‹ã¡ä¸Šã’ã‚‹

```bash
ollama serve
```

ãƒ­ã‚°ä¾‹ï¼š

```
Listening on 127.0.0.1:11434
GPU backend loaded.
```

## 2. FastAPI ã‚’èµ·å‹•

```bash
uvicorn app_full:app --reload
```

## 3. Web UI ã«ã‚¢ã‚¯ã‚»ã‚¹

```
http://127.0.0.1:8000
```

---

# ğŸ“¦ ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆMain Filesï¼‰

## `ollama_client.py`

* ç”»åƒ â†’ Base64 â†’ LLaVA æ¨è«–
* Markdown æ§‹é€ åŒ–å‡ºåŠ›

## `rag_pipeline.py`

* Markdown ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²
* bge-m3 Embedding
* ChromaDB ç™»éŒ²ãƒ»æ¤œç´¢
* gpt-oss:20b ã§ QA

## `app_full.py`

FastAPI æœ¬ä½“

* `/api/analyze` â†’ ç”»åƒ â†’ Markdown â†’ RAGç™»éŒ²
* `/api/query` â†’ è³ªå•å¿œç­”ï¼ˆRAGï¼‰

## `static/index.html`

Web UI

* ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
* Markdown è¡¨ç¤º
* è³ªå•ãƒ•ã‚©ãƒ¼ãƒ 
* å›ç­”ï¼‹å¼•ç”¨æ–‡è„ˆã‚’è¡¨ç¤º

---

# ğŸ§ª å‹•ä½œä¾‹ï¼ˆExampleï¼‰

1. ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
2. Markdown ãŒè‡ªå‹•ç”Ÿæˆ
3. ã€Œã“ã®å›³ã¯ä½•ã‚’è¡¨ã—ã¦ã„ã‚‹ï¼Ÿã€ãªã©è³ªå•
4. RAGã§å›ç­”ãŒè¿”ã£ã¦ãã‚‹
5. å‚ç…§ã•ã‚ŒãŸæ–‡è„ˆï¼ˆãƒãƒ£ãƒ³ã‚¯ï¼‰ã‚‚ç¢ºèªå¯èƒ½

---

# ğŸ›  ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### âŒ `Connection refused: 11434`

Ollama ãŒèµ·å‹•ã—ã¦ã„ã¾ã›ã‚“ã€‚
â†’ `ollama serve` ã‚’å®Ÿè¡Œã€‚

### âŒ Embedding ãŒé‡ã„

â†’ `bge-small` ã«å¤‰æ›´å¯èƒ½ã€‚

### âŒ LLaVA ãŒé‡ã„

â†’ `llava:7b` ã¸å¤‰æ›´ã€‚

---

# â­ Star ã„ãŸã ã‘ã‚‹ã¨åŠ±ã¿ã«ãªã‚Šã¾ã™ï¼

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªãŒå½¹ã«ç«‹ã£ãŸå ´åˆã€
ãœã² ğŸŒŸ ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼